<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/7/2019 11:50:57 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="1701003NB01"
  DTS:CreatorName="IEAD\1701003"
  DTS:DTSID="{AF204FD2-118C-4CB9-855A-FA937757AF3F}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.93"
  DTS:LocaleID="1028"
  DTS:ObjectName="Main_Container_Process"
  DTS:PackageType="5"
  DTS:VersionBuild="172"
  DTS:VersionGUID="{754033BC-EEC1-4535-9411-85DE2808849E}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{CAEA14C3-1CE4-48B5-92A9-FF9A57A4F881}"
      DTS:ObjectName="concurrentFiles">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{993F0E47-A19F-4D30-AB14-4FE020169817}"
      DTS:ObjectName="mailFrom">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{7E16EDDE-FAA3-4363-ACB0-8E4479EC3CB1}"
      DTS:ObjectName="param_mailTo">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{B580F890-B591-4412-90A2-24A34F0BFDC8}"
      DTS:ObjectName="srcEkorg">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{26EF0C6F-DE01-4B7E-BDBA-CF458A035C29}"
      DTS:ObjectName="srcFileFolder">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{81DB8765-8344-4502-B456-62894173EDB2}"
      DTS:ObjectName="srcNatName">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">TW</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{00BEBE8C-C3E0-4D78-AEBD-0E78ADE40A35}"
      DTS:ObjectName="srcSysName">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">LMS</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{410E011F-D9D1-465F-BAC1-22A0CA93DA47}"
      DTS:ObjectName="tableName">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"
        xml:space="preserve"></DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4E9964F4-243C-4769-8B81-66722A20B54F}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="doTableList">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{357C5521-1E84-4FC6-9B80-2BF0D6F6098D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="do_table">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CDFC2680-94D0-49CC-A0FF-D4725E40CA6D}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="fileName">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\檔案執行處理失敗，更新TAB_STATUS為錯誤"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="執行 SQL 工作"
      DTS:DTSID="{1ADAE48A-AB5D-4AC1-9381-90FE8FC19208}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="檔案執行處理失敗，更新TAB_STATUS為錯誤"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
          SQLTask:SqlStatementSource="UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET TAB_STATUS = 3&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND isnull(EKORG,'') = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::srcNatName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Package::srcSysName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Package::srcEkorg"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="$Package::tableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\確認所有檔案都執行完成，更新TAB_STATUS為完成"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="執行 SQL 工作"
      DTS:DTSID="{ECFE14DA-EFC0-4660-9E90-B13B05C7A437}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="確認所有檔案都執行完成，更新TAB_STATUS為完成"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
          SQLTask:SqlStatementSource=" UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET TAB_STATUS = 2&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND isnull(EKORG,'') = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::srcNatName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Package::srcSysName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Package::srcEkorg"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="$Package::tableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\確認有檔案需要執行，更新Status為鎖定"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="執行 SQL 工作"
      DTS:DTSID="{0F66EA61-9B99-435A-8F1B-02D8193DA589}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="確認有檔案需要執行，更新Status為鎖定"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
          SQLTask:SqlStatementSource="UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET STATUS = 2&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND EKORG = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::srcNatName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Package::srcSysName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Package::srcEkorg"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="$Package::tableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\確認檔案都處理完成才執行後續步驟"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="時序容器"
      DTS:DTSID="{A69FE319-9E17-44AD-9134-48F4F4382E1B}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="確認檔案都處理完成才執行後續步驟">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:Description="Foreach 迴圈容器"
          DTS:DTSID="{6E2795D2-23BC-49B4-A2C8-7298FD8A9DCC}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:ForceExecutionResult="0"
          DTS:LocaleID="-1"
          DTS:ObjectName="針對TABLE的資料檔執行Foreach迴圈">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachFromVarEnumerator"
            DTS:DTSID="{2D78CFEC-4E8E-4847-8207-5A2B161A2FA8}"
            DTS:ObjectName="{3A2528A2-C3F7-428C-B5BF-43D958818C94}">
            <DTS:ObjectData>
              <FEEFVE
                VariableName="User::doTableList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\執行PreProcess_Main封裝，開始資料清洗ETL作業"
              DTS:CreationName="Microsoft.ExecutePackageTask"
              DTS:Description="執行封裝工作"
              DTS:DTSID="{3A3ADEC7-B590-40DC-8354-9A1D817335B1}"
              DTS:ExecutableType="Microsoft.ExecutePackageTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="執行PreProcess_Main封裝，開始資料清洗ETL作業"
              DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <ExecutePackageTask>
                  <UseProjectReference>True</UseProjectReference>
                  <PackageName>PreProcess_Main.dtsx</PackageName>
                  <ParameterAssignment>
                    <ParameterName>srcFileFolder</ParameterName>
                    <BindedVariableOrParameterName>$Package::srcFileFolder</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>srcRawDataFileName</ParameterName>
                    <BindedVariableOrParameterName>User::fileName</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>srcSysName</ParameterName>
                    <BindedVariableOrParameterName>$Package::srcSysName</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>param_mailTo</ParameterName>
                    <BindedVariableOrParameterName>$Package::param_mailTo</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>srcNatName</ParameterName>
                    <BindedVariableOrParameterName>$Package::srcNatName</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>mailFrom</ParameterName>
                    <BindedVariableOrParameterName>$Package::mailFrom</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>srcEkorg</ParameterName>
                    <BindedVariableOrParameterName>$Package::srcEkorg</BindedVariableOrParameterName>
                  </ParameterAssignment>
                  <ParameterAssignment>
                    <ParameterName>dbTableName</ParameterName>
                    <BindedVariableOrParameterName>$Package::tableName</BindedVariableOrParameterName>
                  </ParameterAssignment>
                </ExecutePackageTask>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\如未執行，更新TAB_STATUS為執行中"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="執行 SQL 工作"
              DTS:DTSID="{439724BE-2FBE-4F24-866C-01F03056B61A}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="如未執行，更新TAB_STATUS為執行中"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
                  SQLTask:SqlStatementSource="UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET TAB_STATUS = &#xA; (CASE TAB_STATUS WHEN 0 THEN 1&#xA;  ELSE TAB_STATUS END)&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND EKORG = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::srcSysName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="$Package::srcEkorg"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::tableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::srcNatName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈.PrecedenceConstraints[條件約束]"
              DTS:CreationName=""
              DTS:DTSID="{62787E4A-8318-4625-A37E-3E6CB61E0186}"
              DTS:From="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\如未執行，更新TAB_STATUS為執行中"
              DTS:LogicalAnd="True"
              DTS:ObjectName="條件約束"
              DTS:To="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\執行PreProcess_Main封裝，開始資料清洗ETL作業" />
          </DTS:PrecedenceConstraints>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{5F850ECC-0680-4E9B-89D7-E1E946803EF8}"
              DTS:ObjectName="{5F850ECC-0680-4E9B-89D7-E1E946803EF8}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::fileName" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\處理Table資料檔清單"
      DTS:CreationName="Microsoft.ScriptTask"
      DTS:Description="指令碼工作"
      DTS:DTSID="{48D3D08C-C1C3-47F3-BE07-B7CD464D517B}"
      DTS:ExecutableType="Microsoft.ScriptTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="處理Table資料檔清單"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ScriptProject
          Name="ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff"
          VSTAMajorVersion="15"
          VSTAMinorVersion="0"
          Language="CSharp"
          ReadOnlyVariables="$Package::concurrentFiles,$Package::tableName"
          ReadWriteVariables="User::do_table,User::doTableList">
          <ProjectItem
            Name="Properties\AssemblyInfo.cs"
            Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_1c5df127c54d45ba8672f98a885299f8")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_1c5df127c54d45ba8672f98a885299f8")]
[assembly: AssemblyCopyright("Copyright @  2019")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.resx"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
          <ProjectItem
            Name="ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff.csproj"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{15c78f7e-cca3-4839-9de7-da2a13821eca}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_1c5df127c54d45ba8672f98a885299f8</RootNamespace>
    <AssemblyName>ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff</AssemblyName>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
    <TargetFrameworkProfile></TargetFrameworkProfile>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=14.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=14.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="ScriptTask" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" DebugInfoCommandLine="" DebugInfoWorkingDir="" IconImageList="" />
        <Host Name="ScriptTask" GeneratedNamespace="$safeprojectname" IconIndex=""></Host>
        <ProjectClient>
          <HostIdentifier>SSIS_ST140</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
          <ProjectItem
            Name="ScriptMain.cs"
            Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.Linq;
using System.Collections.Generic;
using System.Text.RegularExpressions;
#endregion

namespace ST_1c5df127c54d45ba8672f98a885299f8
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
	public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
	{
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


		/// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
		public void Main()
		{
            try
            {
                string tableName = Dts.Variables["$Package::tableName"].Value.ToString();

                Variables vars = null;
                Dts.VariableDispenser.LockForRead("User::patternTableMap");
                Dts.VariableDispenser.LockForWrite("User::fileExistMap");
                Dts.VariableDispenser.GetVariables(ref vars);
                Dictionary<string, string> patternTableMap = (Dictionary<string, string>)vars["User::patternTableMap"].Value;
                Dictionary<String, Boolean> fileExistMap = (Dictionary<String, Boolean>)vars["User::fileExistMap"].Value;

                List<String> concurrentFiles = Dts.Variables["$Package::concurrentFiles"].Value.ToString().Split(',').ToList();
                bool processFile = false;
                List<String> mappingTableFiles = new List<string>();
                foreach (String fileName in concurrentFiles)
                {
                    if (String.IsNullOrWhiteSpace(fileName))
                    {
                        continue;
                    }
                    bool isZip = fileName.ToUpper().Contains(".ZIP") || fileName.ToUpper().Contains(".RAR") || fileName.ToUpper().Contains(".7Z");
                    String rawDataFilePatternStr = fileNameRegexMatch(patternTableMap, fileName, isZip);

                    Regex srcRawDataFileRegex = new Regex(rawDataFilePatternStr);

                    if (!String.IsNullOrEmpty(rawDataFilePatternStr))
                    {
                        string fileTableName = patternTableMap[rawDataFilePatternStr];
                        if (tableName.ToUpper().Equals(fileTableName.ToUpper()))
                        {
                            processFile = true;
                            fileExistMap[tableName.ToUpper()] = true;
                            mappingTableFiles.Add(fileName);
                        }
                    }
                }
                Dts.Variables["User::do_table"].Value = processFile ? 1 : 0;
                Dts.Variables["User::doTableList"].Value = mappingTableFiles;
                Dts.TaskResult = (int)ScriptResults.Success;
            }
            catch (Exception e)
            {
                Dts.TaskResult = (int)ScriptResults.Failure;
            }
		}

        // 判斷檔名是否有符合pattern，符合傳回pattern String
        public string fileNameRegexMatch(Dictionary<string, string> patternMap, string fileName, bool zipFile)
        {
            string rawDataFilePatternStr = "";
            try { 
                if (zipFile)
                {
                    fileName = fileName.Remove(fileName.LastIndexOf('('), fileName.LastIndexOf(')') - fileName.LastIndexOf('(') + 1);
                }
                foreach (KeyValuePair<string, string> kvp in patternMap)
                {
                    string pattern = kvp.Key;
                    Regex srcRawDataFileRegex = new Regex(pattern);
                    Match srcRawDataFileMatches = srcRawDataFileRegex.Match(fileName);
                    if (srcRawDataFileMatches.Success)
                    {
                        rawDataFilePatternStr = pattern;
                        break;
                    }
                }
                return rawDataFilePatternStr;
            } catch(Exception ex)
            {
                return "";
            }
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

	}
}]]></ProjectItem>
          <ProjectItem
            Name="Project"
            Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="4.0" schemaVersion="1.0">
  <msb:PropertyGroup>
    <msb:CodeName>ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff</msb:CodeName>
    <msb:Language>msBuild</msb:Language>
    <msb:DisplayName>ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff</msb:DisplayName>
    <msb:ProjectId>{9903C4D6-F92F-43EE-B916-3DB4DE196C59}</msb:ProjectId>
  </msb:PropertyGroup>
  <msb:ItemGroup>
    <msb:Project Include="ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff.csproj" />
    <msb:File Include="Properties\Settings.settings" />
    <msb:File Include="Properties\AssemblyInfo.cs" />
    <msb:File Include="Properties\Resources.resx" />
    <msb:File Include="Properties\Resources.Designer.cs" />
    <msb:File Include="Properties\Settings.Designer.cs" />
    <msb:File Include="ScriptMain.cs" />
  </msb:ItemGroup>
</c:Project>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_1c5df127c54d45ba8672f98a885299f8.Properties.Settings.get_Default():ST_1c5df127c54d45ba8672f98a885299f8.Properties.Sett" +
    "ings")]

namespace ST_1c5df127c54d45ba8672f98a885299f8.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.settings"
            Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_1c5df127c54d45ba8672f98a885299f8.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_1c5df127c54d45ba8672f98a885299f8.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_1c5df127c54d45ba8672f98a885299f8.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_1c5df127c54d45ba8672f98a885299f8.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_1c5df127c54d45ba8672f98a885299f8.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
          <BinaryItem
            Name="ST_c8d1cd1e81ce4b4ca9b4f35119b5f8ff.dll">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
AAAAAAAALQGMAAAAAAAOAAAAAAAAAAAAAAA2ARcEAAAAAA4AAAAAAAAAAAAAADYBZQAAAAAABAAA
AAAAAAAAAAAALQHBBAAAAAAEAAAAAAAAAAAAAAAtAV0BAAAAAAAAAAABAAAA6QUAAAUAAgA1AIgA
AAAASUVudW1lcmFibGVgMQBMaXN0YDEASW50MzIAS2V5VmFsdWVQYWlyYDIARGljdGlvbmFyeWAy
AFNUXzFjNWRmMTI3YzU0ZDQ1YmE4NjcyZjk4YTg4NTI5OWY4ADxNb2R1bGU+AE1pY3Jvc29mdC5T
cWxTZXJ2ZXIuTWFuYWdlZERUUwB2YWx1ZV9fAG1zY29ybGliAFN5c3RlbS5Db2xsZWN0aW9ucy5H
ZW5lcmljAExvY2tGb3JSZWFkAEFkZABJc051bGxPcldoaXRlU3BhY2UAZGVmYXVsdEluc3RhbmNl
AFZhcmlhYmxlAEVudW1lcmFibGUASURpc3Bvc2FibGUAUnVudGltZVR5cGVIYW5kbGUAR2V0VHlw
ZUZyb21IYW5kbGUAemlwRmlsZQBmaWxlTmFtZQBNaWNyb3NvZnQuU3FsU2VydmVyLkR0cy5SdW50
aW1lAFR5cGUAU3lzdGVtLkNvcmUARmFpbHVyZQBnZXRfQ3VsdHVyZQBzZXRfQ3VsdHVyZQByZXNv
dXJjZUN1bHR1cmUAVlNUQVJUU2NyaXB0T2JqZWN0TW9kZWxCYXNlAEFwcGxpY2F0aW9uU2V0dGlu
Z3NCYXNlAERpc3Bvc2UARWRpdG9yQnJvd3NhYmxlU3RhdGUATG9ja0ZvcldyaXRlAENvbXBpbGVy
R2VuZXJhdGVkQXR0cmlidXRlAERlYnVnZ2VyTm9uVXNlckNvZGVBdHRyaWJ1dGUARGVidWdnYWJs
ZUF0dHJpYnV0ZQBFZGl0b3JCcm93c2FibGVBdHRyaWJ1dGUAQXNzZW1ibHlUaXRsZUF0dHJpYnV0
ZQBBc3NlbWJseVRyYWRlbWFya0F0dHJpYnV0ZQBUYXJnZXRGcmFtZXdvcmtBdHRyaWJ1dGUAQXNz
ZW1ibHlDb25maWd1cmF0aW9uQXR0cmlidXRlAEFzc2VtYmx5RGVzY3JpcHRpb25BdHRyaWJ1dGUA
Q29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBBc3NlbWJseVByb2R1Y3RBdHRyaWJ1dGUA
QXNzZW1ibHlDb3B5cmlnaHRBdHRyaWJ1dGUAU1NJU1NjcmlwdFRhc2tFbnRyeVBvaW50QXR0cmli
dXRlAEFzc2VtYmx5Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0
ZQBnZXRfVmFsdWUAc2V0X1ZhbHVlAHZhbHVlAFJlbW92ZQBMYXN0SW5kZXhPZgBTVF9jOGQxY2Qx
ZTgxY2U0YjRjYTliNGYzNTExOWI1ZjhmZgBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAFRvU3Ry
aW5nAGZpbGVOYW1lUmVnZXhNYXRjaABNaWNyb3NvZnQuU3FsU2VydmVyLlNjcmlwdFRhc2sATWlj
cm9zb2Z0LlNxbFNlcnZlci5EdHMuVGFza3MuU2NyaXB0VGFzawBTY3JpcHRPYmplY3RNb2RlbABT
eXN0ZW0uQ29tcG9uZW50TW9kZWwAU1RfYzhkMWNkMWU4MWNlNGI0Y2E5YjRmMzUxMTliNWY4ZmYu
ZGxsAGdldF9JdGVtAHNldF9JdGVtAFN5c3RlbQBFbnVtAHJlc291cmNlTWFuAFNjcmlwdE1haW4A
U3lzdGVtLkNvbmZpZ3VyYXRpb24AU3lzdGVtLkdsb2JhbGl6YXRpb24AU3lzdGVtLlJlZmxlY3Rp
b24ARXhjZXB0aW9uAEN1bHR1cmVJbmZvAHBhdHRlcm5NYXAAR3JvdXAAU3lzdGVtLkxpbnEAQ2hh
cgBnZXRfUmVzb3VyY2VNYW5hZ2VyAFRvVXBwZXIAZ2V0X1ZhcmlhYmxlRGlzcGVuc2VyAEdldEVu
dW1lcmF0b3IALmN0b3IALmNjdG9yAFN5c3RlbS5EaWFnbm9zdGljcwBTeXN0ZW0uUnVudGltZS5D
b21waWxlclNlcnZpY2VzAFN5c3RlbS5SZXNvdXJjZXMAU1RfMWM1ZGYxMjdjNTRkNDViYTg2NzJm
OThhODg1Mjk5ZjguUHJvcGVydGllcy5SZXNvdXJjZXMucmVzb3VyY2VzAERlYnVnZ2luZ01vZGVz
AFNUXzFjNWRmMTI3YzU0ZDQ1YmE4NjcyZjk4YTg4NTI5OWY4LlByb3BlcnRpZXMAZ2V0X1Zhcmlh
YmxlcwBHZXRWYXJpYWJsZXMAU2V0dGluZ3MARXF1YWxzAENvbnRhaW5zAFN5c3RlbS5UZXh0LlJl
Z3VsYXJFeHByZXNzaW9ucwBnZXRfU3VjY2VzcwBnZXRfRHRzAFNjcmlwdFJlc3VsdHMAT2JqZWN0
AFNwbGl0AGdldF9EZWZhdWx0AHNldF9UYXNrUmVzdWx0AGdldF9DdXJyZW50AFRvTGlzdABNb3Zl
TmV4dABSZWdleABnZXRfS2V5AGdldF9Bc3NlbWJseQBJc051bGxPckVtcHR5AAAnJABQAGEAYwBr
AGEAZwBlADoAOgB0AGEAYgBsAGUATgBhAG0AZQAAK1UAcwBlAHIAOgA6AHAAYQB0AHQAZQByAG4A
VABhAGIAbABlAE0AYQBwAAAlVQBzAGUAcgA6ADoAZgBpAGwAZQBFAHgAaQBzAHQATQBhAHAAADMk
AFAAYQBjAGsAYQBnAGUAOgA6AGMAbwBuAGMAdQByAHIAZQBuAHQARgBpAGwAZQBzAAAJLgBaAEkA
UAAACS4AUgBBAFIAAAcuADcAWgAAHVUAcwBlAHIAOgA6AGQAbwBfAHQAYQBiAGwAZQAAI1UAcwBl
AHIAOgA6AGQAbwBUAGEAYgBsAGUATABpAHMAdAAAAQBxUwBUAF8AMQBjADUAZABmADEAMgA3AGMA
NQA0AGQANAA1AGIAYQA4ADYANwAyAGYAOQA4AGEAOAA4ADUAMgA5ADkAZgA4AC4AUAByAG8AcABl
AHIAdABpAGUAcwAuAFIAZQBzAG8AdQByAGMAZQBzAAAAAABbkBaEBriiS4OpDulI6b9cAAQgAQEI
AyAAAQUgAQEREQQgAQEOBSABARFtIAcLDhI9FRJBAg4OFRJBAg4CAhUSRQEOFRFJAQ4OAg4OBCAA
En0EIAASPQYgARKAgRwDIAAcAyAADgUgABKAhQYgAQEQEj0GFRJBAg4OBhUSQQIOAgYgAR0OHQMQ
EAEBFRJFAR4AFRKAlQEeAAMKAQ4FFRJFAQ4IIAAVEUkBEwAFFRFJAQ4EIAATAAQAAQIOBCABAg4G
IAETARMAByACARMAEwEFIAEBEwADIAACBCABARwRBwUOFRFRAg4OFRFVAg4ODg4EIAEIAwUgAg4I
CAogABURUQITABMBBhURUQIODgogABURVQITABMBBhURVQIODgYgARKApQ4IAAESgK0RgLEFIAAS
gLUHIAIBDhKAtQi3elxWGTTgiQiJhF3NgIDMkQQAAAAABAEAAAADBhJlAwYSaQMGEhACBggDBhEU
CyADDhUSQQIODg4CBAAAEmUEAAASaQUAAQESaQQAABIQAwAAAQQIABJlBAgAEmkECAASEAgBAAgA
AAAAAB4BAAEAVAIWV3JhcE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAoAQAjU1RfMWM1ZGYx
MjdjNTRkNDViYTg2NzJmOThhODg1Mjk5ZjgAAAUBAAAAABYBABFDb3B5cmlnaHQgQCAgMjAxOQAA
SQEAGi5ORVRGcmFtZXdvcmssVmVyc2lvbj12NC41AQBUDhRGcmFtZXdvcmtEaXNwbGF5TmFtZRIu
TkVUIEZyYW1ld29yayA0LjUAAAC0AAAAzsrvvgEAAACRAAAAbFN5c3RlbS5SZXNvdXJjZXMuUmVz
b3VyY2VSZWFkZXIsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwg
UHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0ZW0uUmVzb3VyY2VzLlJ1bnRpbWVS
ZXNvdXJjZVNldAIAAAAAAAAAAAAAAFBBRFBBRFC0AAAAODUAAAAAAAAAAAAAUjUAAAAgAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAEQ1AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAA
AP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAABABAAAAAYAACAAAAAAAAAAAAAAAAAAAABAAEAAAAwAACAAAAAAAAAAAAAAAAAAAABAAAAAABI
AAAAWEAAABoEAAAAAAAAAAAAABoENAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAA
AAC9BO/+AAABAAAAAQAzcz4cAAABADNzPhw/AAAAAAAAAAQAAAACAAAAAAAAAAAAAAAAAAAARAAA
AAEAVgBhAHIARgBpAGwAZQBJAG4AZgBvAAAAAAAkAAQAAABUAHIAYQBuAHMAbABhAHQAaQBvAG4A
AAAAAAAAsAR6AwAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkAbgBmAG8AAABWAwAAAQAwADAAMAAw
ADAANABiADAAAAAaAAEAAQBDAG8AbQBtAGUAbgB0AHMAAAAAAAAAIgABAAEAQwBvAG0AcABhAG4A
eQBOAGEAbQBlAAAAAAAAAAAAcAAkAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAA
AFMAVABfADEAYwA1AGQAZgAxADIANwBjADUANABkADQANQBiAGEAOAA2ADcAMgBmADkAOABhADgA
OAA1ADIAOQA5AGYAOAAAAD4ADwABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMQAuADAALgA3
ADIAMwAwAC4AMgA5ADQAOQAxAAAAAABwACgAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFMA
VABfAGMAOABkADEAYwBkADEAZQA4ADEAYwBlADQAYgA0AGMAYQA5AGIANABmADMANQAxADEAOQBi
ADUAZgA4AGYAZgAuAGQAbABsAAAASAASAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAA
QwBvAHAAeQByAGkAZwBoAHQAIABAACAAIAAyADAAMQA5AAAAKgABAAEATABlAGcAYQBsAFQAcgBh
AGQAZQBtAGEAcgBrAHMAAAAAAAAAAAB4ACgAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEA
bQBlAAAAUwBUAF8AYwA4AGQAMQBjAGQAMQBlADgAMQBjAGUANABiADQAYwBhADkAYgA0AGYAMwA1
ADEAMQA5AGIANQBmADgAZgBmAC4AZABsAGwAAABoACQAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUA
AAAAAFMAVABfADEAYwA1AGQAZgAxADIANwBjADUANABkADQANQBiAGEAOAA2ADcAMgBmADkAOABh
ADgAOAA1ADIAOQA5AGYAOAAAAEIADwABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEA
LgAwAC4ANwAyADMAMAAuADIAOQA0ADkAMQAAAAAARgAPAAEAQQBzAHMAZQBtAGIAbAB5ACAAVgBl
AHIAcwBpAG8AbgAAADEALgAwAC4ANwAyADMAMAAuADIAOQA0ADkAMQAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAwAAABkNQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</BinaryItem>
        </ScriptProject>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\處理流程結束(失敗)，修改STATUS為使用"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="執行 SQL 工作"
      DTS:DTSID="{E8188275-D795-4F43-91B5-B879FFA2D968}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="處理流程結束(失敗)，修改STATUS為使用"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
          SQLTask:SqlStatementSource=" UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET STATUS = 1&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND isnull(EKORG,'') = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::srcNatName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Package::srcSysName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Package::srcEkorg"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="$Package::tableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\處理流程結束，修改STATUS為使用"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="執行 SQL 工作"
      DTS:DTSID="{45C10BA9-4E3F-407B-B7FC-146B6B05793A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="處理流程結束，修改STATUS為使用"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F1F1D88D-9B56-4830-8096-6067D3DB3248}"
          SQLTask:SqlStatementSource="UPDATE [dbo].[STAGE_TAB_ACT]&#xA;SET STATUS = 1&#xA;WHERE NATIONALITY = ?&#xA; AND SYS_NAME = ?&#xA; AND isnull(EKORG,'') = ?&#xA; AND TABLE_NAME = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::srcNatName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="$Package::srcSysName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="$Package::srcEkorg"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="$Package::tableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束]"
      DTS:CreationName=""
      DTS:DTSID="{A6929443-47CD-4801-B41F-1F85DEA56EEC}"
      DTS:EvalOp="3"
      DTS:Expression="@[User::do_table] &gt; 0"
      DTS:From="Package\處理Table資料檔清單"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束"
      DTS:To="Package\確認有檔案需要執行，更新Status為鎖定" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束 1]"
      DTS:CreationName=""
      DTS:DTSID="{4893AC79-238A-4E32-9465-E55CD549B62B}"
      DTS:From="Package\確認有檔案需要執行，更新Status為鎖定"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束 1"
      DTS:To="Package\確認檔案都處理完成才執行後續步驟" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束 2]"
      DTS:CreationName=""
      DTS:DTSID="{FB0B9EC3-9E3E-487E-B567-E2E18BE8943D}"
      DTS:From="Package\確認檔案都處理完成才執行後續步驟"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束 2"
      DTS:To="Package\確認所有檔案都執行完成，更新TAB_STATUS為完成" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束 3]"
      DTS:CreationName=""
      DTS:DTSID="{E19BF892-6368-48DC-BCC6-8187A7C43B26}"
      DTS:From="Package\確認所有檔案都執行完成，更新TAB_STATUS為完成"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束 3"
      DTS:To="Package\處理流程結束，修改STATUS為使用" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束 3 1]"
      DTS:CreationName=""
      DTS:DTSID="{5E415FE2-0CB7-48DA-8120-FFB234A9DC9D}"
      DTS:From="Package\檔案執行處理失敗，更新TAB_STATUS為錯誤"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束 3 1"
      DTS:To="Package\處理流程結束(失敗)，修改STATUS為使用" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[條件約束 4]"
      DTS:CreationName=""
      DTS:DTSID="{73C71D4E-D655-4443-A781-BFD8D1D14051}"
      DTS:From="Package\確認檔案都處理完成才執行後續步驟"
      DTS:LogicalAnd="True"
      DTS:ObjectName="條件約束 4"
      DTS:To="Package\檔案執行處理失敗，更新TAB_STATUS為錯誤"
      DTS:Value="1" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{47FEC539-F802-4921-B2A6-269D6324B238}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="事件的傳播屬性"
          DTS:DTSID="{322AD7A3-1F07-4E3C-9265-998787741186}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--此 CDATA 區段包含封裝的配置資訊。此區段包括諸如 (x,y) 座標、寬度和長度等資訊。-->
<!--如果您手動編輯此區段但出錯，則可加以刪除。 -->
<!--封裝仍可正常載入，但先前的配置資訊會遺失，而設計師將在設計介面上自動重新排列元素。-->
<Objects
  Version="8">
  <!--下面每個節點將包含不會影響執行階段行為的屬性。-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="193,42"
          Id="Package\處理Table資料檔清單"
          TopLeft="285.166662428114,51.5952571979174" />
        <NodeLayout
          Size="302,42"
          Id="Package\處理流程結束(失敗)，修改STATUS為使用"
          TopLeft="568.999970297021,748.333304220724" />
        <NodeLayout
          Size="270,42"
          Id="Package\處理流程結束，修改STATUS為使用"
          TopLeft="110.833328929213,741.571406369308" />
        <NodeLayout
          Size="293,42"
          Id="Package\確認有檔案需要執行，更新Status為鎖定"
          TopLeft="235.833326743709,140.928567396135" />
        <NodeLayout
          Size="360,42"
          Id="Package\確認所有檔案都執行完成，更新TAB_STATUS為完成"
          TopLeft="63.5000045696891,656.666660578478" />
        <NodeLayout
          Size="288,42"
          Id="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\如未執行，更新TAB_STATUS為執行中"
          TopLeft="31.166661931409,25.3571331318549" />
        <NodeLayout
          Size="233,42"
          Id="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈\執行PreProcess_Main封裝，開始資料清洗ETL作業"
          TopLeft="58.2222163721369,97.952364095215" />
        <EdgeLayout
          Id="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈.PrecedenceConstraints[條件約束]"
          TopLeft="174.944439151773,67.3571331318549">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30.5952309633601"
              Start="0,0"
              End="0,23.0952309633601">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.0952309633601" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="367,195"
          Size="367,238"
          Id="Package\確認檔案都處理完成才執行後續步驟\針對TABLE的資料檔執行Foreach迴圈"
          TopLeft="28.83333240615,26.9523730614559" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="416,315"
          Size="416,358"
          Id="Package\確認檔案都處理完成才執行後續步驟"
          TopLeft="177.499992946784,233.28571713214" />
        <NodeLayout
          Size="324,42"
          Id="Package\檔案執行處理失敗，更新TAB_STATUS為錯誤"
          TopLeft="550.833311445184,660.642844286501" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束]"
          TopLeft="381.999994585912,93.5952571979174">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,47.3333101982176"
              Start="0,0"
              End="0,39.8333101982176">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.8333101982176" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,11.9166550991088,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束 1]"
          TopLeft="383.916659845247,182.928567396135">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,50.357149736005"
              Start="0,0"
              End="0,42.857149736005">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.857149736005" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束 2]"
          TopLeft="317.499992946784,591.28571713214">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-73.999988377095,65.3809434463379"
              Start="0,0"
              End="-73.999988377095,57.8809434463379">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.302678397952" />
                  <mssgle:CubicBezierSegment
                    Point1="0,22.302678397952"
                    Point2="0,26.302678397952"
                    Point3="-4,26.302678397952" />
                  <mssgle:LineSegment
                    End="-69.999988377095,26.302678397952" />
                  <mssgle:CubicBezierSegment
                    Point1="-69.999988377095,26.302678397952"
                    Point2="-73.999988377095,26.302678397952"
                    Point3="-73.999988377095,30.302678397952" />
                  <mssgle:LineSegment
                    End="-73.999988377095,57.8809434463379" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束 3]"
          TopLeft="244.666666749451,698.666660578478">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.90474579083"
              Start="0,0"
              End="0,35.40474579083">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,35.40474579083" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束 3 1]"
          TopLeft="716.416640871102,702.642844286501">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45.690459934223"
              Start="0,0"
              End="0,38.190459934223">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.190459934223" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[條件約束 4]"
          TopLeft="453.499992946784,591.28571713214">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="259.3333184984,69.3571271543611"
              Start="0,0"
              End="259.3333184984,61.8571271543611">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.9022925333637" />
                  <mssgle:CubicBezierSegment
                    Point1="0,23.9022925333637"
                    Point2="0,27.9022925333637"
                    Point3="4,27.9022925333637" />
                  <mssgle:LineSegment
                    End="255.3333184984,27.9022925333637" />
                  <mssgle:CubicBezierSegment
                    Point1="255.3333184984,27.9022925333637"
                    Point2="259.3333184984,27.9022925333637"
                    Point3="259.3333184984,31.9022925333637" />
                  <mssgle:LineSegment
                    End="259.3333184984,61.8571271543611" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="119.2525967492,32.9022925333637,20.828125,10.8330078125"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>